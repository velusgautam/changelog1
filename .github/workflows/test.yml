on: [pull_request]

jobs:
  # new_changelog:
  #   runs-on: ubuntu-latest
  #   name: A job to say hello
  #   steps:
  #     - uses: actions/checkout@v2
  #     - name: Hello world action step
  #       id: hello
  #       uses: velusgautam/changelog1@main
  #       with:
  #         who-to-greet: 'Mona the Octocat'

  commit-back:
    name: commit back
    runs-on: ubuntu-latest
    steps:
      # - uses: actions/setup-node@v2
      #   with:
      #     node-version: '14'
      #     check-latest: true
      - name: Create Changelog
        id: create-change-log
        uses: velusgautam/changelog1@main
        # with:
        #   who-to-greet: 'Mona the Octocat'
      - name: Simulate merged branch
      - uses: actions/checkout@v2
        run: |
          echo $GITHUB_HEAD_REF
          echo $GITHUB_BASE_REF
          git fetch origin $GITHUB_BASE_REF:$GITHUB_BASE_REF $GITHUB_HEAD_REF:$GITHUB_HEAD_REF
          git switch $GITHUB_HEAD_REF
          git checkout $GITHUB_BASE_REF CHANGELOG.md
          echo "${{steps.create-change-log.outputs.changelog}}" >> CHANGELOG.md
          git add CHANGELOG.md
          git config user.name github-actions
          git config user.email github-actions@github.com
          git commit -m "Changelog Commit"
          git push --set-upstream origin $GITHUB_HEAD_REF --no-verify

    # Use the output from the `hello` step
